pdf('../out_GSE56087_nor/out_RSeQC/out.DupRate_plot.pdf')
par(mar=c(5,4,4,5),las=0)
seq_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,237,239,240,241,242,243,244,245,246,247,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,279,280,281,282,283,284,285,286,290,291,292,293,294,295,297,299,300,301,302,303,304,305,308,309,311,312,313,315,316,317,318,319,320,323,325,328,329,333,335,336,337,338,339,341,342,343,344,348,352,357,359,360,362,363,367,368,369,373,377,378,381,382,385,386,389,390,392,393,395,397,398,400,402,403,405,407,408,409,410,412,413,416,417,418,419,424,425,426,427,434,435,438,439,440,442,443,444,445,446,451,452,453,455,456,457,458,459,461,463,465,466,467,472,473,476,477,484,487,496,499,502,505,506,511,521,522,524,525,529,533,546,547,552,556,560,563,569,575,576,578,579,582,584,595,599,602,605,608,631,632,641,642,645,658,664,669,672,679,683,684,689,695,702,706,712,730,732,735,737,753,758,763,770,776,778,780,788,796,802,824,825,829,835,836,860,869,876,884,892,895,896,902,909,920,961,963,1015,1033,1034,1035,1048,1071,1093,1115,1142,1153,1155,1156,1202,1208,1210,1211,1254,1257,1266,1284,1285,1307,1320,1368,1427,1456,1479,1485,1552,1553,1557,1585,1626,1651,1652,1656,1685,1783,1843,2118,2196,2199,2214,2224,2247,2370,2466,2486,2744,2767,2834,2883,3164,3365,3544,3670,5959,7070,7921)
seq_uniqRead=c(6225161,401134,113855,52175,29430,18486,12528,8848,6763,5187,4089,3350,2779,2313,1996,1652,1445,1244,1094,989,819,818,749,707,571,537,480,452,397,342,315,337,283,266,272,235,252,216,181,182,186,152,153,154,145,121,106,127,119,116,106,102,102,95,84,89,102,74,80,66,53,57,69,71,63,57,58,51,57,44,60,30,44,35,35,39,41,28,44,35,34,32,36,32,32,23,30,25,34,35,32,30,25,27,23,24,32,14,24,23,17,24,15,22,20,19,19,20,18,13,20,17,15,12,14,20,16,22,12,13,16,21,17,16,15,14,9,15,12,8,13,10,13,10,9,11,11,12,18,9,9,12,7,6,5,5,12,9,8,15,4,5,6,13,6,3,9,10,6,5,8,15,9,10,6,10,4,9,4,10,3,6,10,7,6,5,8,11,5,7,8,4,4,8,5,6,4,10,3,6,5,5,1,6,4,3,6,3,4,3,6,5,1,1,3,4,5,6,2,4,2,4,5,1,8,4,2,5,1,5,4,5,3,1,3,2,3,3,4,4,6,1,1,3,2,3,2,4,4,4,1,3,3,2,2,4,1,1,1,6,1,2,4,1,1,2,2,2,2,3,1,2,3,3,2,1,1,2,4,4,2,1,1,2,1,3,1,1,1,2,2,3,2,1,2,1,2,3,1,1,4,2,1,2,1,2,1,2,1,1,1,1,3,1,4,4,1,2,3,1,5,1,2,2,1,1,1,1,2,1,1,1,1,2,3,1,4,2,2,1,5,1,1,1,1,1,3,1,1,1,1,3,1,1,1,1,1,1,2,1,2,1,3,2,2,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,2,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
pos_occ=c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,287,288,289,290,291,292,293,295,296,297,298,299,300,301,302,303,304,305,306,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,326,327,328,329,331,332,333,335,336,337,338,339,340,342,344,345,346,347,348,349,350,352,353,354,355,356,357,358,359,360,361,362,363,366,368,369,370,371,372,373,374,375,376,377,378,379,381,382,384,385,386,387,388,389,390,391,393,394,396,397,398,399,400,401,404,405,407,408,409,411,413,414,415,416,417,418,419,420,422,423,424,425,426,427,428,429,430,431,432,433,435,437,439,441,442,443,444,445,446,447,448,449,452,453,454,455,456,457,459,460,461,462,463,464,465,466,467,468,469,470,472,473,475,477,480,481,482,483,484,485,486,488,489,490,491,493,504,505,506,507,508,509,510,511,512,514,515,516,518,519,521,522,523,524,527,528,529,530,534,535,538,540,542,543,544,545,546,547,551,553,555,556,560,561,562,563,568,570,573,575,576,577,580,581,582,583,585,589,591,593,597,598,599,603,604,606,607,608,609,610,612,613,619,620,621,622,624,628,633,634,637,641,642,646,647,652,653,655,657,662,663,665,666,670,673,676,677,680,682,683,684,685,686,689,692,696,702,703,704,705,707,709,713,721,722,725,727,729,733,739,741,742,745,748,750,752,757,758,766,777,778,784,786,791,794,796,801,804,805,808,809,810,816,817,819,823,827,834,842,843,851,855,858,861,864,866,870,879,885,888,894,905,907,908,923,928,933,937,950,959,961,970,973,987,989,996,999,1001,1007,1010,1014,1015,1016,1021,1025,1027,1051,1052,1059,1062,1065,1070,1082,1086,1104,1108,1117,1124,1125,1135,1138,1144,1154,1155,1159,1161,1162,1167,1172,1174,1178,1180,1182,1186,1207,1209,1230,1242,1250,1282,1289,1295,1297,1310,1315,1318,1332,1352,1356,1360,1379,1391,1392,1410,1421,1428,1447,1454,1456,1499,1502,1542,1566,1571,1584,1599,1600,1670,1686,1706,1718,1723,1740,1743,1914,1947,1978,2015,2058,2066,2074,2088,2170,2176,2208,2218,2220,2222,2250,2257,2294,2421,2466,2477,2597,2667,2736,2865,2874,2935,3009,3095,3156,3239,3366,3423,3659,3740,3928,4077,4147,4249,4950,5007,5011,5042,5460,7616,8106,9728,14759)
pos_uniqRead=c(4230426,481683,155432,75704,43891,28460,20176,15193,11638,8977,7297,5872,4977,4246,3654,3173,2761,2448,2252,1965,1729,1567,1390,1193,1154,1074,989,906,824,800,676,707,632,580,554,523,500,447,413,406,371,355,328,331,331,298,269,250,234,255,232,202,208,208,182,166,175,151,173,172,161,139,135,126,110,109,118,87,108,119,100,111,100,101,90,90,87,94,67,76,76,91,84,76,65,69,76,50,56,65,56,54,43,62,46,47,44,46,53,53,46,35,39,51,46,31,38,26,42,47,34,35,37,26,34,30,32,32,31,27,26,32,40,37,28,25,21,25,28,22,22,21,25,24,16,23,23,13,27,18,17,18,23,12,13,21,8,18,16,15,11,16,19,16,22,13,12,15,18,14,12,15,18,25,17,10,6,7,7,8,17,14,15,11,11,9,8,11,15,10,12,8,9,11,5,10,12,10,13,10,11,11,5,5,10,5,10,9,11,8,7,10,9,12,11,8,8,5,13,7,8,5,10,11,9,8,4,8,10,11,11,9,10,4,7,6,6,7,6,12,6,6,7,5,3,10,11,8,6,1,6,6,5,1,6,4,5,4,5,6,6,7,7,4,3,3,6,7,7,8,2,5,6,7,6,3,4,9,2,4,6,4,5,4,2,2,4,5,5,3,6,3,6,3,4,6,5,4,1,1,3,1,4,1,3,1,3,1,6,5,3,4,5,1,3,4,3,5,4,3,4,7,7,5,1,3,3,3,1,3,2,8,3,3,4,1,2,5,2,3,3,1,2,2,7,2,2,2,4,3,3,5,2,5,2,1,3,1,4,4,4,2,3,2,3,2,2,2,3,2,1,4,3,1,2,2,3,3,3,2,1,1,1,2,1,4,4,2,1,1,2,3,1,1,3,3,1,1,1,1,1,3,2,3,1,2,2,3,4,1,3,4,2,3,4,2,1,2,1,1,3,1,2,2,2,1,3,1,1,1,2,1,2,1,4,1,1,1,3,1,2,3,1,1,1,3,1,2,1,2,1,3,1,2,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,2,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,4,3,2,1,2,2,3,1,1,2,1,1,1,3,1,1,2,1,2,1,1,3,1,2,2,1,1,2,1,2,1,1,2,1,2,1,1,1,1,1,1,1,1,1,3,1,2,1,1,1,1,1,2,2,1,2,1,1,1,1,1,3,1,1,1,2,1,1,2,1,1,1,2,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1)
plot(pos_occ,log10(pos_uniqRead),ylab='Number of Reads (log10)',xlab='Occurrence of read',pch=4,cex=0.8,col='blue',xlim=c(1,500),yaxt='n')
points(seq_occ,log10(seq_uniqRead),pch=20,cex=0.8,col='red')
ym=floor(max(log10(pos_uniqRead)))
legend(300,ym,legend=c('Sequence-based','Mapping-based'),col=c('blue','red'),pch=c(4,20))
axis(side=2,at=0:ym,labels=0:ym)
axis(side=4,at=c(log10(pos_uniqRead[1]),log10(pos_uniqRead[2]),log10(pos_uniqRead[3]),log10(pos_uniqRead[4])), labels=c(round(pos_uniqRead[1]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[2]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[3]*100/sum(pos_uniqRead*pos_occ)),round(pos_uniqRead[4]*100/sum(pos_uniqRead*pos_occ))))
mtext(4, text = "Reads %", line = 2)
dev.off()
